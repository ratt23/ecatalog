{
  "version": 3,
  "sources": ["file:///D:/schedule-project-main/netlify/functions/imageProxy.js"],
  "sourceRoot": "C:/Users/rattputt/AppData/Local/Temp/tmp-17592-6dpa9w0FzGMT",
  "sourcesContent": ["export async function handler(event, context) {\r\n    const origin = event.headers.origin || event.headers.Origin || '';\n  const allowedOrigins = [\n    'https://shab.web.id',\n    'https://jadwaldoktershab.netlify.app',\n    'https://dashdev1.netlify.app',\n    'https://dashdev2.netlify.app',\n    'http://localhost:3000',\n    'http://localhost:3001',\n    'http://localhost:5173'\n  ];\n\n  const headers = {\n    'Access-Control-Allow-Origin': allowedOrigins.includes(origin) ? origin : '*',\r\n        'Access-Control-Allow-Headers': 'Content-Type',\r\n        'Access-Control-Allow-Methods': 'GET, OPTIONS',\r\n    };\r\n\r\n    if (event.httpMethod === 'OPTIONS') {\r\n        return { statusCode: 200, headers, body: '' };\r\n    }\r\n\r\n    try {\r\n        const imageUrl = event.queryStringParameters?.url;\r\n\r\n        if (!imageUrl) {\r\n            return {\r\n                statusCode: 400,\r\n                headers,\r\n                body: JSON.stringify({ message: 'Image URL required' })\r\n            };\r\n        }\r\n\r\n        // Fetch Image\r\n        const response = await fetch(imageUrl);\r\n\r\n        if (!response.ok) {\r\n            return {\r\n                statusCode: response.status,\r\n                headers,\r\n                body: JSON.stringify({ message: 'Failed to fetch image' })\r\n            };\r\n        }\r\n\r\n        const contentType = response.headers.get('content-type') || 'application/octet-stream';\r\n        const buffer = await response.arrayBuffer();\r\n\r\n        return {\r\n            statusCode: 200,\r\n            headers: {\r\n                ...headers,\r\n                'Content-Type': contentType,\r\n                'Cache-Control': 'public, max-age=86400' // Cache for 1 day\r\n            },\r\n            body: Buffer.from(buffer).toString('base64'),\r\n            isBase64Encoded: true\r\n        };\r\n\r\n    } catch (error) {\r\n        console.error('Image Proxy error:', error);\r\n        return {\r\n            statusCode: 500,\r\n            headers,\r\n            body: JSON.stringify({ message: 'Server error', error: error.message })\r\n        };\r\n    }\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAAsB,QAAQ,OAAO,SAAS;AAC1C,QAAM,SAAS,MAAM,QAAQ,UAAU,MAAM,QAAQ,UAAU;AACjE,QAAM,iBAAiB;AAAA,IACrB;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF;AAEA,QAAM,UAAU;AAAA,IACd,+BAA+B,eAAe,SAAS,MAAM,IAAI,SAAS;AAAA,IACtE,gCAAgC;AAAA,IAChC,gCAAgC;AAAA,EACpC;AAEA,MAAI,MAAM,eAAe,WAAW;AAChC,WAAO,EAAE,YAAY,KAAK,SAAS,MAAM,GAAG;AAAA,EAChD;AAEA,MAAI;AACA,UAAM,WAAW,MAAM,uBAAuB;AAE9C,QAAI,CAAC,UAAU;AACX,aAAO;AAAA,QACH,YAAY;AAAA,QACZ;AAAA,QACA,MAAM,KAAK,UAAU,EAAE,SAAS,qBAAqB,CAAC;AAAA,MAC1D;AAAA,IACJ;AAGA,UAAM,WAAW,MAAM,MAAM,QAAQ;AAErC,QAAI,CAAC,SAAS,IAAI;AACd,aAAO;AAAA,QACH,YAAY,SAAS;AAAA,QACrB;AAAA,QACA,MAAM,KAAK,UAAU,EAAE,SAAS,wBAAwB,CAAC;AAAA,MAC7D;AAAA,IACJ;AAEA,UAAM,cAAc,SAAS,QAAQ,IAAI,cAAc,KAAK;AAC5D,UAAM,SAAS,MAAM,SAAS,YAAY;AAE1C,WAAO;AAAA,MACH,YAAY;AAAA,MACZ,SAAS;AAAA,QACL,GAAG;AAAA,QACH,gBAAgB;AAAA,QAChB,iBAAiB;AAAA;AAAA,MACrB;AAAA,MACA,MAAM,OAAO,KAAK,MAAM,EAAE,SAAS,QAAQ;AAAA,MAC3C,iBAAiB;AAAA,IACrB;AAAA,EAEJ,SAAS,OAAO;AACZ,YAAQ,MAAM,sBAAsB,KAAK;AACzC,WAAO;AAAA,MACH,YAAY;AAAA,MACZ;AAAA,MACA,MAAM,KAAK,UAAU,EAAE,SAAS,gBAAgB,OAAO,MAAM,QAAQ,CAAC;AAAA,IAC1E;AAAA,EACJ;AACJ;",
  "names": []
}
